<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ’çƒè¨ˆåˆ†æ¿ (æ…¶ç¥ç‰ˆ)</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --team-a-color: #3b82f6; /* è—è‰² */
            --team-b-color: #ef4444; /* ç´…è‰² */
            --bg-color: #1f2937;
            --text-color: #ffffff;
            --winner-color: #fbbf24; /* é‡‘è‰² */
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        h1 { margin-bottom: 20px; font-size: 1.5rem; opacity: 0.8; }

        /* è¨­å®šå€å¡Š */
        .settings {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        input[type="text"] {
            padding: 10px;
            border-radius: 5px;
            border: none;
            font-size: 1rem;
            text-align: center;
            width: 150px;
        }

        /* è¨ˆåˆ†ä¸»é«” */
        .scoreboard {
            display: flex;
            gap: 20px;
            width: 100%;
            max-width: 800px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .team-card {
            flex: 1;
            min-width: 300px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            border-top: 5px solid transparent;
            transition: all 0.3s ease;
            overflow: hidden; /* ç¢ºä¿å…‰æ•ˆä¸æº¢å‡º */
        }

        .team-card.team-a { border-color: var(--team-a-color); }
        .team-card.team-b { border-color: var(--team-b-color); }

        /* ç²å‹æ¨£å¼ */
        .team-card.winner-state {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.2) 0%, rgba(217, 119, 6, 0.4) 100%);
            border-color: var(--winner-color) !important;
            box-shadow: 0 0 30px rgba(251, 191, 36, 0.6);
            transform: scale(1.05);
            z-index: 10;
        }

        /* å‹åˆ©æ¨™ç±¤ */
        .winner-badge {
            display: none;
            background-color: var(--winner-color);
            color: #000;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.2rem;
            margin-bottom: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .team-card.winner-state .winner-badge { display: block; }
        .team-card.winner-state .team-name-display { color: var(--winner-color); }
        .team-card.winner-state .score-display { color: #fff; text-shadow: 0 2px 10px rgba(0,0,0,0.5); }

        @keyframes popIn {
            0% { transform: scale(0); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .team-name-display {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
            text-align: center;
            min-height: 40px;
        }

        .score-display {
            font-size: 8rem;
            font-weight: bold;
            line-height: 1;
            cursor: pointer;
            user-select: none;
            padding: 10px 0;
            width: 100%;
            text-align: center;
            transition: transform 0.1s;
        }
        
        .score-display:active { transform: scale(0.95); }
        .team-a .score-display { color: var(--team-a-color); }
        .team-b .score-display { color: var(--team-b-color); }

        .controls { display: flex; gap: 10px; margin-top: 10px; align-items: center; }

        button {
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: background 0.2s;
        }

        .btn-minus { background-color: #4b5563; color: white; }
        .btn-minus:hover { background-color: #6b7280; }

        .sets-display {
            margin-top: 20px;
            font-size: 1.2rem;
            background: rgba(0,0,0,0.3);
            padding: 5px 15px;
            border-radius: 20px;
        }
        
        .btn-set-add {
            background-color: #10b981;
            color: white;
            font-size: 0.9rem;
            margin-left: 10px;
        }

        .global-actions { margin-top: 40px; display: flex; gap: 15px; }
        .btn-action { padding: 12px 24px; font-size: 1.1rem; background-color: #8b5cf6; color: white; }
        .btn-reset { background-color: #6b7280; }
        .btn-new-set { background-color: #f59e0b; color: black; }
        .hint { margin-top: 5px; font-size: 0.8rem; color: #9ca3af; }

        @media (max-width: 650px) {
            .scoreboard { flex-direction: column; align-items: center; }
            .team-card { width: 90%; }
        }
    </style>
</head>
<body>

    <h1>ğŸ æ’çƒè¨ˆåˆ†æ¿</h1>

    <div class="settings">
        <input type="text" id="inputNameA" placeholder="å·¦å´éšŠå (A)" oninput="updateNames()">
        <button class="btn-action" onclick="swapSides()">ğŸ”„ äº¤æ›å ´åœ°</button>
        <input type="text" id="inputNameB" placeholder="å³å´éšŠå (B)" oninput="updateNames()">
    </div>

    <div class="scoreboard">
        <div class="team-card team-a" id="cardA">
            <div class="winner-badge">ğŸ† WINNER</div>
            <div class="team-name-display" id="displayNameA">A éšŠ</div>
            
            <div class="score-display" id="scoreElA" onclick="addScore('A')" title="é»æ“ŠåŠ åˆ†">0</div>
            <div class="hint">é»æ“Šæ•¸å­—åŠ åˆ†</div>

            <div class="controls">
                <button class="btn-minus" onclick="subScore('A')">-1 åˆ†</button>
            </div>

            <div class="sets-display">
                å±€æ•¸: <span id="setsA">0</span>
                <button class="btn-set-add" onclick="addSet('A')">+1 å±€</button>
            </div>
        </div>

        <div class="team-card team-b" id="cardB">
            <div class="winner-badge">ğŸ† WINNER</div>
            <div class="team-name-display" id="displayNameB">B éšŠ</div>
            
            <div class="score-display" id="scoreElB" onclick="addScore('B')" title="é»æ“ŠåŠ åˆ†">0</div>
            <div class="hint">é»æ“Šæ•¸å­—åŠ åˆ†</div>

            <div class="controls">
                <button class="btn-minus" onclick="subScore('B')">-1 åˆ†</button>
            </div>

            <div class="sets-display">
                å±€æ•¸: <span id="setsB">0</span>
                <button class="btn-set-add" onclick="addSet('B')">+1 å±€</button>
            </div>
        </div>
    </div>

    <div class="global-actions">
        <button class="btn-new-set" onclick="newSet()">ä¸‹ä¸€å±€ (åˆ†æ•¸æ­¸é›¶)</button>
        <button class="btn-reset" onclick="resetMatch()">æ•´å ´é‡ç½®</button>
    </div>

    <script>
        // åˆå§‹åŒ–è®Šæ•¸
        let scoreA = 0;
        let scoreB = 0;
        let setsA = 0;
        let setsB = 0;
        let isSwapped = false; // false = Aå·¦Bå³, true = Bå·¦Aå³
        let isGameOver = false; // é˜²æ­¢è´äº†ä¹‹å¾Œé‚„ç¹¼çºŒåŠ åˆ†(å¯é¸)

        // DOM å…ƒç´ 
        const elScoreA = document.getElementById('scoreElA');
        const elScoreB = document.getElementById('scoreElB');
        const elSetsA = document.getElementById('setsA');
        const elSetsB = document.getElementById('setsB');
        const inputA = document.getElementById('inputNameA');
        const inputB = document.getElementById('inputNameB');
        const displayA = document.getElementById('displayNameA');
        const displayB = document.getElementById('displayNameB');
        const cardA = document.getElementById('cardA');
        const cardB = document.getElementById('cardB');

        function updateNames() {
            if (isSwapped) {
                displayA.textContent = inputB.value || 'B éšŠ';
                displayB.textContent = inputA.value || 'A éšŠ';
            } else {
                displayA.textContent = inputA.value || 'A éšŠ';
                displayB.textContent = inputB.value || 'B éšŠ';
            }
        }

        function updateDisplay() {
            // è™•ç†æ•¸å­—é¡¯ç¤º
            if (isSwapped) {
                elScoreA.textContent = scoreB;
                elSetsA.textContent = setsB;
                elScoreB.textContent = scoreA;
                elSetsB.textContent = setsA;
            } else {
                elScoreA.textContent = scoreA;
                elSetsA.textContent = setsA;
                elScoreB.textContent = scoreB;
                elSetsB.textContent = setsB;
            }
            
            // æ¯æ¬¡æ›´æ–°éƒ½æª¢æŸ¥æ˜¯å¦æœ‰ç²å‹è€…
            checkWinner();
        }

        // æª¢æŸ¥ç²å‹ç‹€æ…‹ (æ ¸å¿ƒé‚è¼¯)
        function checkWinner() {
            // æ¸…é™¤ä¹‹å‰çš„ç²å‹æ¨£å¼
            cardA.classList.remove('winner-state');
            cardB.classList.remove('winner-state');

            // å–å¾—ç•¶å‰åœ¨å·¦é‚Šå’Œå³é‚Šçš„åˆ†æ•¸
            let leftScore = parseInt(elScoreA.textContent);
            let rightScore = parseInt(elScoreB.textContent);

            // ç²å‹æ¢ä»¶ï¼šåˆ†æ•¸ >= 25 ä¸” é ˜å…ˆ >= 2 åˆ†
            // å·¦é‚Šè´
            if (leftScore >= 25 && (leftScore - rightScore) >= 2) {
                cardA.classList.add('winner-state');
                triggerConfetti();
            }
            // å³é‚Šè´
            else if (rightScore >= 25 && (rightScore - leftScore) >= 2) {
                cardB.classList.add('winner-state');
                triggerConfetti();
            }
        }

        // è§¸ç™¼ç…™ç«ç‰¹æ•ˆ
        function triggerConfetti() {
            // éš¨æ©Ÿç™¼å°„ç…™ç«
            var duration = 3 * 1000;
            var animationEnd = Date.now() + duration;
            var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };

            var random = function(min, max) {
              return Math.random() * (max - min) + min;
            };

            var interval = setInterval(function() {
              var timeLeft = animationEnd - Date.now();

              if (timeLeft <= 0) {
                return clearInterval(interval);
              }

              var particleCount = 50 * (timeLeft / duration);
              // å…©å€‹ç™¼å°„æºï¼Œå·¦å³å„ä¸€
              confetti(Object.assign({}, defaults, { particleCount, origin: { x: random(0.1, 0.3), y: Math.random() - 0.2 } }));
              confetti(Object.assign({}, defaults, { particleCount, origin: { x: random(0.7, 0.9), y: Math.random() - 0.2 } }));
            }, 250);
        }

        function addScore(side) {
            // åˆ¤æ–·é‚è¼¯
            if (side === 'A') {
                isSwapped ? scoreB++ : scoreA++;
            } else {
                isSwapped ? scoreA++ : scoreB++;
            }
            updateDisplay();
        }

        function subScore(side) {
            if (side === 'A') {
                if (isSwapped) { if(scoreB > 0) scoreB--; } 
                else { if(scoreA > 0) scoreA--; }
            } else {
                if (isSwapped) { if(scoreA > 0) scoreA--; } 
                else { if(scoreB > 0) scoreB--; }
            }
            updateDisplay();
        }

        function addSet(side) {
            if (side === 'A') {
                isSwapped ? setsB++ : setsA++;
            } else {
                isSwapped ? setsA++ : setsB++;
            }
            updateDisplay();
        }

        function swapSides() {
            isSwapped = !isSwapped;
            
            // CSS æ¨£å¼äº¤æ›
            if (isSwapped) {
                cardA.classList.remove('team-a'); cardA.classList.add('team-b');
                cardB.classList.remove('team-b'); cardB.classList.add('team-a');
            } else {
                cardA.classList.remove('team-b'); cardA.classList.add('team-a');
                cardB.classList.remove('team-a'); cardB.classList.add('team-b');
            }

            updateNames();
            updateDisplay();
        }

        function newSet() {
            if(confirm('ç¢ºå®šè¦é–‹å§‹æ–°çš„ä¸€å±€å—ï¼Ÿç›®å‰åˆ†æ•¸å°‡æ­¸é›¶ã€‚')) {
                scoreA = 0;
                scoreB = 0;
                cardA.classList.remove('winner-state'); // æ¸…é™¤ç²å‹ç‹€æ…‹
                cardB.classList.remove('winner-state');
                updateDisplay();
            }
        }

        function resetMatch() {
            if(confirm('ç¢ºå®šè¦é‡ç½®æ•´å ´æ¯”è³½å—ï¼Ÿæ‰€æœ‰åˆ†æ•¸èˆ‡å±€æ•¸å°‡æ¸…ç©ºã€‚')) {
                scoreA = 0; scoreB = 0;
                setsA = 0; setsB = 0;
                cardA.classList.remove('winner-state');
                cardB.classList.remove('winner-state');
                updateDisplay();
            }
        }

        // åˆå§‹åŒ–
        updateNames();
    </script>
</body>
</html>
